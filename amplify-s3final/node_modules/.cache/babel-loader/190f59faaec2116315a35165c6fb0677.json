{"ast":null,"code":"import _slicedToArray from\"/Users/kedouard/Documents/SA/Labs/sbd-team-s3-bucket/amplify-s3final/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import Amplify from'aws-amplify';import{AmplifyAuthenticator,AmplifyGreetings,AmplifySignIn}from'@aws-amplify/ui-react';import{AuthState,onAuthUIStateChange}from'@aws-amplify/ui-components';import awsconfig from'./aws-exports';import AWS from'aws-sdk';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";Amplify.configure(awsconfig);var S3_BUCKET='sbd-sharedbucket';var REGION='us-east-1';AWS.config.update({accessKeyId:'AKIA263JUYZWG744QZGA',secretAccessKey:'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',httpOptions:{timeout:900000,connectTimeout:5000}});var myBucket=new AWS.S3({params:{Bucket:S3_BUCKET},region:REGION});var UploadImageToS3WithNativeSdk=function UploadImageToS3WithNativeSdk(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),progress=_useState2[0],setProgress=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),selectedFile=_useState4[0],setSelectedFile=_useState4[1];// const username = Auth.currentAuthenticatedUser().then((user) => {\n//   console.log('user email = ' + user.attributes.email)\n// })\nvar handleFileInput=function handleFileInput(e){setSelectedFile(e.target.files[0]);};var _React$useState=React.useState(),_React$useState2=_slicedToArray(_React$useState,2),authState=_React$useState2[0],setAuthState=_React$useState2[1];var _React$useState3=React.useState(),_React$useState4=_slicedToArray(_React$useState3,2),user=_React$useState4[0],setUser=_React$useState4[1];React.useEffect(function(){return onAuthUIStateChange(function(nextAuthState,authData){setAuthState(nextAuthState);setUser(authData);console.log('authdata: ',authData);});},[]);var uploadFile=function uploadFile(file){var params={ACL:'public-read',Body:file,Bucket:S3_BUCKET,Key:file.name};myBucket.putObject(params).on('httpUploadProgress',function(evt){setProgress(Math.round(evt.loaded/evt.total*100));}).send(function(err){if(err)console.log(err);});};return authState===AuthState.SignedIn&&user?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{class:\"airwolf-header\",children:[/*#__PURE__*/_jsx(\"span\",{class:\"airwolf-header-stripe-shine one\",children:\" \"}),/*#__PURE__*/_jsx(\"span\",{class:\"airwolf-header-stripe-shine two\",children:\" \"}),/*#__PURE__*/_jsx(\"span\",{class:\"airwolf-header-stripe-fade one\",children:\" \"}),/*#__PURE__*/_jsx(\"span\",{class:\"airwolf-header-stripe-fade two\",children:\" \"}),/*#__PURE__*/_jsx(\"span\",{class:\"airwolf-header-stripe-fade three\",children:\" \"}),/*#__PURE__*/_jsx(\"span\",{class:\"airwolf-header-stripe-fade four\",children:\" \"}),/*#__PURE__*/_jsx(\"span\",{class:\"airwolf-header-stripe-fade five\",children:\" \"}),/*#__PURE__*/_jsx(\"span\",{class:\"airwolf-header-title\",children:\"Stanley Black & Decker\"}),/*#__PURE__*/_jsx(\"span\",{class:\"airwolf-header-subtitle\",children:\"Internal S3 Uploader\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(AmplifyAuthenticator,{usernameAlias:\"email\",children:[/*#__PURE__*/_jsx(AmplifySignIn,{headerText:\"Hey, Sign in to your account\",slot:\"sign-in\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(AmplifyGreetings,{username:user.attributes.email,children:\" \"})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"File Upload Progress is \",progress,\"%\"]}),/*#__PURE__*/_jsx(\"div\",{children:\" \"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleFileInput}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){uploadFile(selectedFile);},children:\" Upload to S3\"})]})]}):/*#__PURE__*/_jsx(AmplifyAuthenticator,{});};export default UploadImageToS3WithNativeSdk;","map":{"version":3,"sources":["/Users/kedouard/Documents/SA/Labs/sbd-team-s3-bucket/amplify-s3final/src/App.js"],"names":["React","useState","Amplify","AmplifyAuthenticator","AmplifyGreetings","AmplifySignIn","AuthState","onAuthUIStateChange","awsconfig","AWS","configure","S3_BUCKET","REGION","config","update","accessKeyId","secretAccessKey","httpOptions","timeout","connectTimeout","myBucket","S3","params","Bucket","region","UploadImageToS3WithNativeSdk","progress","setProgress","selectedFile","setSelectedFile","handleFileInput","e","target","files","authState","setAuthState","user","setUser","useEffect","nextAuthState","authData","console","log","uploadFile","file","ACL","Body","Key","name","putObject","on","evt","Math","round","loaded","total","send","err","SignedIn","attributes","email"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport Amplify from 'aws-amplify'\nimport { AmplifyAuthenticator, AmplifyGreetings, AmplifySignIn } from '@aws-amplify/ui-react'\nimport { AuthState, onAuthUIStateChange } from '@aws-amplify/ui-components'\nimport awsconfig from './aws-exports'\nimport AWS from 'aws-sdk'\n\nAmplify.configure(awsconfig)\n\nconst S3_BUCKET = 'sbd-sharedbucket'\nconst REGION = 'us-east-1'\n\nAWS.config.update({\n  accessKeyId: 'AKIA263JUYZWG744QZGA',\n  secretAccessKey: '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',\n  httpOptions: { timeout: 900000, connectTimeout: 5000 }\n})\n\nconst myBucket = new AWS.S3({\n  params: { Bucket: S3_BUCKET },\n  region: REGION\n})\n\nconst UploadImageToS3WithNativeSdk = () => {\n  const [progress, setProgress] = useState(0)\n  const [selectedFile, setSelectedFile] = useState(null)\n\n  // const username = Auth.currentAuthenticatedUser().then((user) => {\n  //   console.log('user email = ' + user.attributes.email)\n  // })\n\n  const handleFileInput = (e) => {\n    setSelectedFile(e.target.files[0])\n  }\n\n  const [authState, setAuthState] = React.useState()\n  const [user, setUser] = React.useState()\n\n  React.useEffect(() => {\n    return onAuthUIStateChange((nextAuthState, authData) => {\n      setAuthState(nextAuthState)\n      setUser(authData)\n      console.log('authdata: ', authData)\n    })\n  }, [])\n\n  const uploadFile = (file) => {\n    const params = {\n      ACL: 'public-read',\n      Body: file,\n      Bucket: S3_BUCKET,\n      Key: file.name\n    }\n\n    myBucket.putObject(params)\n      .on('httpUploadProgress', (evt) => {\n        setProgress(Math.round((evt.loaded / evt.total) * 100))\n      })\n      .send((err) => {\n        if (err) console.log(err)\n      })\n  }\n\n  return authState === AuthState.SignedIn && user ? (\n    <>\n      <div class='airwolf-header'>\n        <span class='airwolf-header-stripe-shine one'> </span>\n        <span class='airwolf-header-stripe-shine two'> </span>\n        <span class='airwolf-header-stripe-fade one'> </span>\n        <span class='airwolf-header-stripe-fade two'> </span>\n        <span class='airwolf-header-stripe-fade three'> </span>\n        <span class='airwolf-header-stripe-fade four'> </span>\n        <span class='airwolf-header-stripe-fade five'> </span>\n        <span class='airwolf-header-title'>Stanley Black & Decker</span>\n        <span class='airwolf-header-subtitle'>Internal S3 Uploader</span>\n      </div>\n\n      <div>\n        <AmplifyAuthenticator usernameAlias='email'>\n          <AmplifySignIn headerText='Hey, Sign in to your account' slot='sign-in' />\n          <div>\n            <AmplifyGreetings username={user.attributes.email}> </AmplifyGreetings>\n          </div>\n        </AmplifyAuthenticator>\n\n        <div>File Upload Progress is {progress}%</div>\n        <div> </div>\n        <input type='file' onChange={handleFileInput} />\n        <button onClick={function () { uploadFile(selectedFile) }}> Upload to S3</button>\n      </div>\n    </>\n  ) : (\n    <AmplifyAuthenticator />\n  )\n}\n\nexport default UploadImageToS3WithNativeSdk\n"]},"metadata":{},"sourceType":"module"}